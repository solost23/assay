import{k as e}from"./driver.165ffb93.js";import{_ as t,d as a,B as n,r as l,X as o,z as i,L as r,Y as s,i as u,o as d,c,f as p,w as m,e as v,h as f,n as g,F as x,A as h,t as y,q as b,k as S,G as _,p as k,m as w}from"./index.1248482e.js";const C=e=>(k("data-v-2e4a78f8"),e=e(),w(),e),J={class:"app-container home"},N={class:"search-input"},T=["onDblclick","onClick","title"],I=S("停止所有预览"),B=S("停止所有回放"),P={key:0,id:"drive-input",class:"flex items-center justify-center mt16 w-full"},D=[C((()=>v("label",{class:"cursor-pointer w-full p-4 transition ease-in-out delay-150 bg-slate-200 dark:bg-[#262626] rounded-2 shadow border border-white justify-start items-center gap-3 inline-flex"},[v("input",{type:"checkbox",class:"checkbox"}),v("span",{class:"dark:text-[#F2F2F2] text-gray-8 break-words overflow-y-auto grow"},"这是一个示例")],-1)))];var V=t(a({__name:"index",setup(t){const{proxy:a}=_();let S=n([]),k=n([]);const w=l("0"),C=l(""),V=l([]),R=l(""),M=l(0),W=l(""),q=l(null);l([]);let z=0,F="",j=null;o(C,((e,t)=>{e||(S=k)}));const O=l(Boolean(sessionStorage.getItem("todo-driver"))),A=e({showProgress:!0,allowClose:!0,onDestroyed:()=>{O.value=!0,sessionStorage.setItem("todo-driver","true")},steps:[{popover:{title:"首次使用向导",description:"欢迎来到本系统，接下来将为你介绍使用方式",nextBtnText:"下一步",prevBtnText:"前一步"}},{element:"#screenfull",popover:{title:"全屏展示",description:"点击切换全屏展示",nextBtnText:"下一步",prevBtnText:"前一步"}},{element:"#drive-help",popover:{title:"操作提示",description:"点击显示操作提示",nextBtnText:"下一步",prevBtnText:"前一步"}},{element:"#drive-input",popover:{title:"事项",description:"单击完成该事项",prevBtnText:"前一步",nextBtnText:"下一步",side:"bottom",align:"center"}},{element:"#drive-trash",popover:{title:"删除",description:"单击移除该事项",prevBtnText:"前一步",nextBtnText:"完成",side:"bottom",align:"center",onNextClick:()=>{O.value=!0,sessionStorage.setItem("todo-driver","true"),A.moveNext()}}}]});function H(){j=new WebControl({szPluginContainer:"video_home",iServicePortStart:15900,iServicePortEnd:15900,cbConnectSuccess:()=>{j.JS_StartService("window",{dllPath:"./VideoPluginConnect.dll"}).then((()=>{j.JS_SetWindowControlCallback({cbIntegrationCallBack:void 0}),j.JS_CreateWnd("video_home",M.value,W.value).then((()=>{var e;e=()=>{var e,t,a="asdfghj1",n=(e="admin",(t=new JSEncrypt).setPublicKey(F),t.encrypt(e)),l="http://192.168.1.68/",o=Number(w.value),i="443",r="D:\\SnapDir",s="D:\\VideoDir",u="2x2",d=1,c="secret",p=1,m=0,v="0,16,256,257,258,259,260,512,513,514,515,516,517,768,769",f=2;j.JS_RequestInterface({funcName:"init",argument:JSON.stringify({appkey:a,secret:n,ip:l,playMode:o,port:i,snapDir:r,videoDir:s,layout:u,enableHTTPS:d,encryptedFields:c,showToolbar:p,showSmart:m,buttonIDs:v,reconnectTimes:f})}).then((()=>{j.JS_Resize(M.value,W.value)}))},j.JS_RequestInterface({funcName:"getRSAPubKey",argument:JSON.stringify({keyLength:1024})}).then((function(t){t.responseMsg.data&&(F=t.responseMsg.data,e())}))}))}),(function(){}))},cbConnectError:function(){j=null,WebControl.JS_WakeUp("VideoWebPlugin://"),z++,z<3&&setTimeout((()=>{H()}),3e3)}})}function U(e){if("0"===w.value)!function(e){j.JS_RequestInterface({funcName:"startPreview",argument:JSON.stringify({cameraIndexCode:e,streamMode:0,transMode:1,gpuMode:0})})}(e);else{if(!V.value.length)return void a.$message.warning("请选择回放时间");const t=new Date(V.value[0]).getTime(),n=new Date(V.value[1]).getTime();!function(e,t,a){j.JS_RequestInterface({funcName:"startPlayback",argument:JSON.stringify({cameraIndexCode:e,startTimeStamp:t,endTimeStamp:a,recordLocation:1,transMode:1,gpuMode:0})})}(e,Number(t)/1e3,Number(n)/1e3)}}function E(){const e=k.filter((e=>e.cameraName.indexOf(C.value)>-1));S=e}function L(){j.JS_Resize(M.value-650,W.value)}function K(){j.JS_Resize(M.value,W.value)}function G(){j.JS_Disconnect().then((()=>{H()}))}return i((()=>{O.value||A.drive(),r((()=>{M.value=q.value.clientWidth,W.value=q.value.clientHeight,H()}))})),s((()=>{j.JS_HideWnd()})),(e,t)=>{const a=u("el-button"),n=u("el-input"),l=u("el-menu-item"),o=u("el-menu-item-group"),i=u("el-empty"),r=u("el-menu"),s=u("el-aside"),_=u("el-radio-button"),k=u("el-radio-group"),M=u("el-date-picker"),W=u("el-header"),z=u("el-main"),F=u("el-container");return d(),c("div",J,[p(F,{style:{border:"1px solid #eee"}},{default:m((()=>[p(s,{width:"300px"},{default:m((()=>[p(r,null,{default:m((()=>[v("div",N,[p(n,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e),placeholder:"请输入关键字",class:"input-with-select"},{append:m((()=>[p(a,{icon:"Search",onClick:E})])),_:1},8,["modelValue"])]),f(S).length?(d(),g(o,{key:0,style:{"margin-top":"20px"}},{default:m((()=>[(d(!0),c(x,null,h(f(S),((e,t)=>(d(),g(l,{key:t,index:e.cameraIndexCode},{default:m((()=>[v("div",{onDblclick:t=>U(e.cameraIndexCode),onClick:t=>R.value=e.cameraIndexCode,title:e.cameraName,class:"cameraName-list"},y(e.cameraName),41,T)])),_:2},1032,["index"])))),128))])),_:1})):(d(),g(i,{key:1,description:"暂无数据"}))])),_:1})])),_:1}),p(F,null,{default:m((()=>[p(W,null,{default:m((()=>[v("div",null,[p(a,{type:"primary",plain:"",onClick:t[1]||(t[1]=e=>{j.JS_RequestInterface({funcName:"stopAllPreview"})})},{default:m((()=>[I])),_:1}),p(a,{type:"primary",plain:"",onClick:t[2]||(t[2]=e=>{j.JS_RequestInterface({funcName:"stopAllPlayback"})})},{default:m((()=>[B])),_:1})]),v("div",null,[p(k,{modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=e=>w.value=e),onChange:G,style:{"margin-right":"10px","vertical-align":"middle"}},{default:m((()=>[p(_,{label:"实时预览",value:"0"}),p(_,{label:"录像回放",value:"1"})])),_:1},8,["modelValue"]),p(M,{style:{"z-index":"99999"},modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=e=>V.value=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",disabled:"0"===w.value,onFocus:L,onBlur:K,onChange:t[5]||(t[5]=e=>U(R.value))},null,8,["modelValue","disabled"])])])),_:1}),p(z,null,{default:m((()=>[v("div",{id:"video_home",ref_key:"videoHome",ref:q},null,512)])),_:1})])),_:1})])),_:1}),O.value?b("",!0):(d(),c("div",P,D))])}}}),[["__scopeId","data-v-2e4a78f8"]]);export{V as default};
