import{d as e,K as l,r as a,L as t,i as o,M as u,o as n,c as r,f as s,w as i,N as d,n as p,e as c,t as m,O as f,k as v,G as g}from"./index.1248482e.js";import{c as h,d as b}from"./user.250f5db6.js";const w={class:"app-container"},_=c("h4",{class:"form-header h4"},"基本信息",-1),x=c("h4",{class:"form-header h4"},"角色信息",-1),N={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},k=v("提交"),y=v("返回"),I=e({name:"AuthRole"}),R=e({...I,setup(e){const v=l(),{proxy:I}=g(),R=a(!0),V=a(0),$=a(1),C=a(10),S=a([]),U=a([]),j=a({nickName:void 0,userName:void 0,userId:void 0});function T(e){I.$refs.roleRef.toggleRowSelection(e)}function K(e){S.value=e.map((e=>e.roleId))}function O(e){return e.roleId}function A(){I.$tab.closeOpenPage({path:"/system/user"})}return(()=>{const e=v.params&&v.params.userId;e&&(R.value=!0,h(e).then((e=>{j.value=e.user,U.value=e.roles,V.value=U.value.length,t((()=>{U.value.forEach((e=>{e.flag&&I.$refs.roleRef.toggleRowSelection(e)}))})),R.value=!1})))})(),(e,l)=>{const a=o("el-input"),t=o("el-form-item"),v=o("el-col"),g=o("el-row"),h=o("el-form"),E=o("el-table-column"),G=o("el-table"),L=o("pagination"),M=o("el-button"),P=u("loading");return n(),r("div",w,[_,s(h,{model:j.value,"label-width":"80px"},{default:i((()=>[s(g,null,{default:i((()=>[s(v,{span:8,offset:2},{default:i((()=>[s(t,{label:"用户昵称",prop:"nickName"},{default:i((()=>[s(a,{modelValue:j.value.nickName,"onUpdate:modelValue":l[0]||(l[0]=e=>j.value.nickName=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),s(v,{span:8,offset:2},{default:i((()=>[s(t,{label:"登录账号",prop:"userName"},{default:i((()=>[s(a,{modelValue:j.value.userName,"onUpdate:modelValue":l[1]||(l[1]=e=>j.value.userName=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"]),x,d((n(),p(G,{"row-key":O,onRowClick:T,ref:"roleRef",onSelectionChange:K,data:U.value.slice(($.value-1)*C.value,$.value*C.value)},{default:i((()=>[s(E,{label:"序号",width:"55",type:"index",align:"center"},{default:i((e=>[c("span",null,m(($.value-1)*C.value+e.$index+1),1)])),_:1}),s(E,{type:"selection","reserve-selection":!0,width:"55"}),s(E,{label:"角色编号",align:"center",prop:"roleId"}),s(E,{label:"角色名称",align:"center",prop:"roleName"}),s(E,{label:"权限字符",align:"center",prop:"roleKey"}),s(E,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:i((l=>[c("span",null,m(e.parseTime(l.row.createTime)),1)])),_:1})])),_:1},8,["data"])),[[P,R.value]]),d(s(L,{total:V.value,page:$.value,"onUpdate:page":l[2]||(l[2]=e=>$.value=e),limit:C.value,"onUpdate:limit":l[3]||(l[3]=e=>C.value=e)},null,8,["total","page","limit"]),[[f,V.value>0]]),s(h,{"label-width":"100px"},{default:i((()=>[c("div",N,[s(M,{type:"primary",onClick:l[4]||(l[4]=e=>function(){const e=j.value.userId,l=S.value.join(",");b({userId:e,roleIds:l}).then((e=>{200===e.code&&(I.$modal.msgSuccess("授权成功"),A())}))}())},{default:i((()=>[k])),_:1}),s(M,{onClick:l[5]||(l[5]=e=>A())},{default:i((()=>[y])),_:1})])])),_:1})])}}});export{R as default};
