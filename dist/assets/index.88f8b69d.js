import{r as e,z as l,G as a,L as t,d,i as n,M as s,o,c as i,N as u,O as r,h as p,f as c,w as m,j as h,F as b,A as f,n as g,k as _,t as v,q as y,V as k,e as w}from"./index.1248482e.js";import{l as C,p as I,a as V,g as S,u as T,b as N,d as x,c as U}from"./dept.58daf09e.js";import{d as R}from"./index.4bc46672.js";const q={class:"app-container"},z=_("重置"),A=_("搜索"),D=_("新增"),L=_("展开/折叠"),P=_("修改"),$=_("删除"),F=w("span",{class:"table_link_text"},"修改",-1),O=w("span",{class:"table_link_text"},"新增",-1),Q=w("span",{class:"table_link_text"},"删除",-1),j=w("span",{class:"table_link_text"},"修改",-1),E=w("span",{class:"table_link_text"},"新增",-1),G=w("span",{class:"table_link_text"},"删除",-1),K={class:"dialog-footer"},M=_("确 定"),B=_("取 消"),H=d({name:"Dept"}),J=d({...H,setup(d){const{loading:H,open:J,showSearch:W,title:X,deptOptions:Y,deptList:Z,isExpandAll:ee,refreshTable:le,queryParams:ae,form:te,rules:de,sys_normal_disable:ne,queryRef:se,statusOptions:oe,deptRef:ie,single:ue,multiple:re,pageTable:pe,pageLoading:ce,total:me,pageTableList:he,switchIcon:be,tableSwitch:fe,getPage:ge,handleSwitch:_e,cancel:ve,multipleSelection:ye,batchDelete:ke,handleQuery:we,resetQuery:Ce,handleAdd:Ie,toggleExpandAll:Ve,handleUpdate:Se,submitForm:Te,handleDelete:Ne,ids:xe,pageTableRef:Ue,cleanSelect:Re}=(()=>{const{proxy:d}=a(),{sys_normal_disable:n}=d.useDict("sys_normal_disable"),s=e(),o=e(),i=e(!1),u=e(!0),r=e(!0),p=e(""),c=e(),m=e(!0),h=e(!0),b=e(),f=e({pageNum:1,pageSize:10,deptName:void 0,status:void 0}),g=e({parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}),_=e(),v=e(!0),y=e(!0),k=e(!1),w=e(0),q=e(),z=e("分页表格"),A=e("list"),D=e(!0),L=e(),P=e(),$=e(),F=async()=>{u.value=!0,await C(f.value).then((e=>{200===e.code&&(o.value=d.handleTree(e.data,"deptId"),u.value=!1)}))},O=async()=>{D.value=!0,await I(f.value).then((e=>{if(200===e.code){const l=e.data;q.value=l.rows,w.value=parseInt(l.total),D.value=!1}}))},Q=()=>{d.cleanTableSelection($)},j=()=>{b.value={deptId:void 0,parentId:void 0,deptName:void 0,orderNum:0,leader:void 0,phone:void 0,email:void 0,status:"0"},d.resetForm(L)},E=()=>{0!==w.value||k.value?O():F()},G=R((()=>{_.value=[],k.value=!k.value,h.value=!h.value,!k.value&&h.value?(w.value=0,z.value="分页表格",A.value="list",F()):(z.value="树形表格",A.value="grid",O())}),700,!0);return l((()=>{F(),d.getDicts("sys_normal_disable").then((e=>{s.value=e.data}))})),{loading:u,open:i,showSearch:r,title:p,deptOptions:c,deptList:o,isExpandAll:m,refreshTable:h,queryParams:f,form:b,rules:g,sys_normal_disable:n,queryRef:P,statusOptions:s,deptRef:L,single:v,multiple:y,pageTable:k,pageLoading:D,total:w,pageTableList:q,switchIcon:A,tableSwitch:z,getPage:O,handleSwitch:G,cancel:()=>{j(),Q(),i.value=!1},multipleSelection:e=>{_.value=e.map((e=>e.deptId)),v.value=1!=e.length,y.value=!e.length},batchDelete:()=>{const e=_.value;d.$modal.confirm('是否确认删除编号为【"'+e+'"】的数据?').then((()=>U(e))).then((e=>{200===e.code&&d.$modal.msgSuccess("批量删除成功"),O()})).catch((()=>{Q()}))},handleQuery:E,resetQuery:()=>{d.resetForm(P),E()},handleAdd:async e=>{j(),await C().then((e=>{200===e.code&&(c.value=d.handleTree(e.data,"deptId"))})),null!=e&&(b.value.parentId=e.deptId),p.value="添加部门",i.value=!0},toggleExpandAll:()=>{h.value=!1,m.value=!m.value,t((()=>{h.value=!0}))},handleUpdate:async e=>{const l=e.deptId||_.value[0];j(),await V(l).then((e=>{200===e.code&&(c.value=d.handleTree(e.data,"deptId"))})),await S(l).then((l=>{if(200===l.code){const a=l.data;a.orderNum=parseInt(a.orderNum),"0"===a.parentId&&(a.parentId=parseInt(a.parentId)),b.value=a,p.value="修改部门",d.setTableRowSelected($,e,!0),i.value=!0}}))},submitForm:async()=>{var e;await(null==(e=L.value)?void 0:e.validate((e=>{e&&(void 0!==b.value.deptId?T(b.value).then((e=>{200===e.code&&(d.$modal.msgSuccess("修改成功"),i.value=!1,E())})):N(b.value).then((e=>{200===e.code&&(d.$modal.msgSuccess("新增成功"),i.value=!1,E())})))})))},handleDelete:e=>{d.setTableRowSelected($,e,!0),d.$modal.confirm('是否确认删除名称为"'+e.deptName+'"的数据项?').then((()=>x(e.deptId))).then((e=>{200===e.code&&(d.$modal.msgSuccess("删除成功"),F())})).catch((()=>{d.setTableRowSelected($,e,!1)}))},ids:_,pageTableRef:$,cleanSelect:Q}})();return(e,l)=>{const a=n("el-input"),t=n("el-form-item"),d=n("el-option"),C=n("el-select"),I=n("el-button"),V=n("el-form"),S=n("el-col"),T=n("right-toolbar"),N=n("el-row"),x=n("el-table-column"),U=n("data-single-tag"),R=n("el-link"),qe=n("el-table"),ze=n("pagination"),Ae=n("el-tree-select"),De=n("el-input-number"),Le=n("el-radio"),Pe=n("el-radio-group"),$e=n("el-dialog"),Fe=s("hasPermi"),Oe=s("loading");return o(),i("div",q,[u(c(V,{ref_key:"queryRef",ref:se,model:p(ae),inline:!0},{default:m((()=>[c(t,{label:"部门名称",prop:"deptName"},{default:m((()=>[c(a,{modelValue:p(ae).deptName,"onUpdate:modelValue":l[0]||(l[0]=e=>p(ae).deptName=e),placeholder:"请输入部门名称",clearable:"",onKeyup:l[1]||(l[1]=h((e=>p(we)()),["enter"])),onClear:l[2]||(l[2]=e=>p(we)())},null,8,["modelValue"])])),_:1}),c(t,{label:"状态",prop:"status"},{default:m((()=>[c(C,{modelValue:p(ae).status,"onUpdate:modelValue":l[3]||(l[3]=e=>p(ae).status=e),placeholder:"部门状态",clearable:"",onChange:l[4]||(l[4]=e=>p(we)())},{default:m((()=>[(o(!0),i(b,null,f(p(ne),(e=>(o(),g(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(t,null,{default:m((()=>[c(I,{icon:"Refresh",onClick:l[5]||(l[5]=e=>p(Ce)())},{default:m((()=>[z])),_:1}),c(I,{type:"primary",icon:"Search",onClick:l[6]||(l[6]=e=>p(we)())},{default:m((()=>[A])),_:1})])),_:1})])),_:1},8,["model"]),[[r,p(W)]]),c(N,{gutter:10,class:"mb8"},{default:m((()=>[c(S,{span:1.5},{default:m((()=>[u((o(),g(I,{type:"primary",plain:"",size:"small",icon:"Plus",onClick:p(Ie)},{default:m((()=>[D])),_:1},8,["onClick"])),[[Fe,["system:dept:add"]]])])),_:1},8,["span"]),c(S,{span:1.5},{default:m((()=>[c(I,{type:"primary",plain:"",size:"small",icon:p(be),onClick:l[7]||(l[7]=e=>p(_e)()),title:"切换到"+p(fe)},{default:m((()=>[_(v(p(fe)),1)])),_:1},8,["icon","title"])])),_:1},8,["span"]),0===p(me)?(o(),g(S,{key:0,span:1.5},{default:m((()=>[c(I,{type:"info",plain:"",size:"small",icon:"Sort",onClick:l[8]||(l[8]=e=>p(Ve)())},{default:m((()=>[L])),_:1})])),_:1},8,["span"])):y("",!0),p(ue)||1!==p(xe).length?y("",!0):(o(),g(S,{key:1,span:1.5},{default:m((()=>[p(ue)?y("",!0):u((o(),g(I,{key:0,type:"success",plain:"",icon:"edit",size:"small",disabled:p(ue),onClick:p(Se)},{default:m((()=>[P])),_:1},8,["disabled","onClick"])),[[Fe,["system:dict:edit"]]])])),_:1},8,["span"])),!p(re)&&p(xe).length>=1?(o(),g(S,{key:2,span:1.5},{default:m((()=>[p(re)?y("",!0):u((o(),g(I,{key:0,type:"danger",plain:"",icon:"delete",size:"small",disabled:p(re),onClick:p(ke)},{default:m((()=>[$])),_:1},8,["disabled","onClick"])),[[Fe,["system:dict:remove"]]])])),_:1},8,["span"])):y("",!0),c(T,{showSearch:p(W),"onUpdate:showSearch":l[9]||(l[9]=e=>k(W)?W.value=e:null),onQueryTable:l[10]||(l[10]=e=>p(we)())},null,8,["showSearch"])])),_:1}),p(le)?u((o(),g(qe,{key:0,border:"",stripe:"",data:p(Z),"row-key":"deptId","default-expand-all":p(ee),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:m((()=>[c(x,{prop:"deptName",label:"部门名称"}),c(x,{prop:"deptId",label:"编号",align:"left",width:"200"}),c(x,{prop:"orderNum",label:"排序"}),c(x,{prop:"status",label:"状态"},{default:m((e=>[c(U,{"single-data":e.row.status,"status-options":p(oe)},null,8,["single-data","status-options"])])),_:1}),c(x,{label:"创建日期",align:"center",prop:"createTime",width:"300"},{default:m((l=>[w("span",null,v(e.dateTimeSub(l.row.createTime)),1)])),_:1}),c(x,{label:"修改日期",align:"center",prop:"updateTime",width:"300"},{default:m((l=>[w("span",null,v(e.dateTimeSub(l.row.updateTime)),1)])),_:1}),c(x,{label:"操作",align:"center",width:"300","class-name":"small-padding fixed-width"},{default:m((e=>[u((o(),g(R,{class:"table_link_btn",underline:!1,type:"primary",icon:"edit",onClick:l=>p(Se)(e.row)},{default:m((()=>[F])),_:2},1032,["onClick"])),[[Fe,["system:dept:edit"]]]),u((o(),g(R,{class:"table_link_btn",underline:!1,type:"primary",icon:"plus",onClick:l=>p(Ie)(e.row)},{default:m((()=>[O])),_:2},1032,["onClick"])),[[Fe,["system:dept:add"]]]),0!=e.row.parentId?u((o(),g(R,{key:0,class:"table_link_btn",underline:!1,type:"danger",icon:"delete",onClick:l=>p(Ne)(e.row)},{default:m((()=>[Q])),_:2},1032,["onClick"])),[[Fe,["system:dept:remove"]]]):y("",!0)])),_:1})])),_:1},8,["data","default-expand-all"])),[[Oe,p(H)]]):y("",!0),p(pe)?u((o(),g(qe,{key:1,border:"",stripe:"",ref_key:"pageTableRef",ref:Ue,data:p(he),onSelectionChange:p(ye)},{default:m((()=>[c(x,{type:"selection",align:"center",width:"55"}),c(x,{prop:"deptName",label:"部门名称"}),c(x,{prop:"deptId",label:"编号",align:"center",width:"200"}),c(x,{prop:"orderNum",label:"排序"}),c(x,{prop:"status",label:"状态",align:"center",width:"200"},{default:m((e=>[c(U,{"single-data":e.row.status,"status-options":p(oe)},null,8,["single-data","status-options"])])),_:1}),c(x,{label:"创建时间",align:"center",prop:"createTime",width:"300"},{default:m((e=>[w("span",null,v(e.row.createTime),1)])),_:1}),c(x,{label:"修改时间",align:"center",prop:"updateTime",width:"300"},{default:m((e=>[w("span",null,v(e.row.updateTime),1)])),_:1}),c(x,{label:"操作",align:"center",width:"200","class-name":"small-padding fixed-width"},{default:m((e=>[u((o(),g(R,{class:"table_link_btn",underline:!1,type:"primary",icon:"edit",onClick:l=>p(Se)(e.row)},{default:m((()=>[j])),_:2},1032,["onClick"])),[[Fe,["system:dept:edit"]]]),u((o(),g(R,{class:"table_link_btn",underline:!1,type:"primary",icon:"plus",onClick:l=>p(Ie)(e.row)},{default:m((()=>[E])),_:2},1032,["onClick"])),[[Fe,["system:dept:add"]]]),0!=e.row.parentId?u((o(),g(R,{key:0,class:"table_link_btn",underline:!1,type:"danger",icon:"delete",onClick:l=>p(Ne)(e.row)},{default:m((()=>[G])),_:2},1032,["onClick"])),[[Fe,["system:dept:remove"]]]):y("",!0)])),_:1})])),_:1},8,["data","onSelectionChange"])),[[Oe,p(ce)]]):y("",!0),u(c(ze,{total:p(me),page:p(ae).pageNum,"onUpdate:page":l[11]||(l[11]=e=>p(ae).pageNum=e),limit:p(ae).pageSize,"onUpdate:limit":l[12]||(l[12]=e=>p(ae).pageSize=e),onPagination:l[13]||(l[13]=e=>p(ge)())},null,8,["total","page","limit"]),[[r,p(pe)&&p(me)>0]]),c($e,{title:p(X),modelValue:p(J),"onUpdate:modelValue":l[23]||(l[23]=e=>k(J)?J.value=e:null),width:"30%","append-to-body":"",onClosed:l[24]||(l[24]=e=>p(Re)())},{footer:m((()=>[w("div",K,[c(I,{type:"primary",onClick:l[21]||(l[21]=e=>p(Te)())},{default:m((()=>[M])),_:1}),c(I,{onClick:l[22]||(l[22]=e=>p(ve)())},{default:m((()=>[B])),_:1})])])),default:m((()=>[c(V,{ref_key:"deptRef",ref:ie,model:p(te),rules:p(de),"label-width":"100px"},{default:m((()=>[c(N,null,{default:m((()=>[0!==p(te).parentId?(o(),g(S,{key:0,span:24},{default:m((()=>[c(t,{label:"上级部门",prop:"parentId"},{default:m((()=>[c(Ae,{modelValue:p(te).parentId,"onUpdate:modelValue":l[14]||(l[14]=e=>p(te).parentId=e),data:p(Y),props:{value:"deptId",label:"deptName",children:"children"},"value-key":"deptId",placeholder:"选择上级部门","check-strictly":"",filterable:"","render-after-expand":!1,style:{width:"100%"}},null,8,["modelValue","data"])])),_:1})])),_:1})):y("",!0),c(S,{span:12},{default:m((()=>[c(t,{label:"部门名称",prop:"deptName"},{default:m((()=>[c(a,{modelValue:p(te).deptName,"onUpdate:modelValue":l[15]||(l[15]=e=>p(te).deptName=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1})])),_:1}),c(S,{span:12},{default:m((()=>[c(t,{label:"显示排序",prop:"orderNum"},{default:m((()=>[c(De,{modelValue:p(te).orderNum,"onUpdate:modelValue":l[16]||(l[16]=e=>p(te).orderNum=e),"controls-position":"right",min:0,style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),c(S,{span:12},{default:m((()=>[c(t,{label:"负责人",prop:"leader"},{default:m((()=>[c(a,{modelValue:p(te).leader,"onUpdate:modelValue":l[17]||(l[17]=e=>p(te).leader=e),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])])),_:1})])),_:1}),c(S,{span:12},{default:m((()=>[c(t,{label:"联系电话",prop:"phone"},{default:m((()=>[c(a,{modelValue:p(te).phone,"onUpdate:modelValue":l[18]||(l[18]=e=>p(te).phone=e),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])])),_:1})])),_:1}),c(S,{span:12},{default:m((()=>[c(t,{label:"邮箱",prop:"email"},{default:m((()=>[c(a,{modelValue:p(te).email,"onUpdate:modelValue":l[19]||(l[19]=e=>p(te).email=e),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])])),_:1})])),_:1}),c(S,{span:12},{default:m((()=>[c(t,{label:"部门状态"},{default:m((()=>[c(Pe,{modelValue:p(te).status,"onUpdate:modelValue":l[20]||(l[20]=e=>p(te).status=e)},{default:m((()=>[(o(!0),i(b,null,f(p(ne),(e=>(o(),g(Le,{key:e.value,label:e.value},{default:m((()=>[_(v(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])}}});export{J as default};
