import{d as e,r as a,B as l,u as t,c as o,e as s,f as r,w as i,i as u,o as d,n as p,q as f,D as n,_ as m,k as c,p as g,m as v,G as h}from"./index.1248482e.js";import{u as C}from"./user.250f5db6.js";const x=e=>(g("data-v-3628f626"),e=e(),v(),e),_=["src"],w={class:"avatar-upload-preview"},y=["src"],k=x((()=>s("br",null,null,-1))),b=c(" 选择 "),z=x((()=>s("i",{class:"upload -right"},null,-1))),B=c("提 交"),$=e({name:"UserAvatar"});var H=m(e({...$,setup(e){const{proxy:m}=h(),c=a(!1),g=a(!1),v=a("修改头像"),x=l({img:t().avatar,autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0,previews:{url:"",img:""}}),$=()=>{g.value=!0},H=()=>{},R=e=>{e=e||1,m.$refs.cropper.changeScale(e)},W=e=>{if(-1==e.type.indexOf("image/"))m.$modal.msgError("文件格式错误，请上传图片类型,如：JPG，PNG后缀的文件。");else{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>{x.img=a.result}}},D=e=>{x.previews=e};return(e,a)=>{const l=u("vue-cropper"),h=u("el-col"),G=u("el-row"),U=u("el-button"),V=u("el-upload"),j=u("el-dialog");return d(),o("div",null,[s("div",{class:"user-info-head",onClick:a[0]||(a[0]=e=>{c.value=!0})},[s("img",{src:x.img,title:"点击上传头像",class:"img-circle img-lg"},null,8,_)]),r(j,{title:v.value,modelValue:c.value,"onUpdate:modelValue":a[6]||(a[6]=e=>c.value=e),width:"800px","append-to-body":"",onOpened:$},{default:i((()=>[r(G,null,{default:i((()=>[r(h,{xs:24,md:12,style:{height:"350px"}},{default:i((()=>[g.value?(d(),p(l,{key:0,ref:"cropper",img:x.img,info:!0,autoCrop:x.autoCrop,autoCropWidth:x.autoCropWidth,autoCropHeight:x.autoCropHeight,fixedBox:x.fixedBox,onRealTime:D},null,8,["img","autoCrop","autoCropWidth","autoCropHeight","fixedBox"])):f("",!0)])),_:1}),r(h,{xs:24,md:12,style:{height:"350px"}},{default:i((()=>[s("div",w,[s("img",{src:x.previews.url,style:n(x.previews.img)},null,12,y)])])),_:1})])),_:1}),k,r(G,null,{default:i((()=>[r(h,{lg:2,md:2},{default:i((()=>[r(V,{action:"#","http-request":H,"show-file-list":!1,"before-upload":W},{default:i((()=>[r(U,{size:"small"},{default:i((()=>[b,z])),_:1})])),_:1})])),_:1}),r(h,{lg:{span:1,offset:2},md:2},{default:i((()=>[r(U,{icon:"plus",size:"small",onClick:a[1]||(a[1]=e=>R(1))})])),_:1}),r(h,{lg:{span:1,offset:1},md:2},{default:i((()=>[r(U,{icon:"minus",size:"small",onClick:a[2]||(a[2]=e=>R(-1))})])),_:1}),r(h,{lg:{span:1,offset:1},md:2},{default:i((()=>[r(U,{icon:"refresh-left",size:"small",onClick:a[3]||(a[3]=e=>{m.$refs.cropper.rotateLeft()})})])),_:1}),r(h,{lg:{span:1,offset:1},md:2},{default:i((()=>[r(U,{icon:"refresh-right",size:"small",onClick:a[4]||(a[4]=e=>{m.$refs.cropper.rotateRight()})})])),_:1}),r(h,{lg:{span:2,offset:6},md:2},{default:i((()=>[r(U,{type:"primary",size:"small",onClick:a[5]||(a[5]=e=>{m.$refs.cropper.getCropBlob((e=>{let a=new FormData;a.append("avatarfile",e),C(a).then((e=>{200===e.code&&(c.value=!1,x.img="//localhost:8080"+e.data,t().avatar=x.img,m.$modal.msgSuccess("修改成功"),g.value=!1)}))}))})},{default:i((()=>[B])),_:1})])),_:1})])),_:1})])),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-3628f626"]]);export{H as default};
