import{I as e,r as a,z as l,G as o,d as t,i as n,M as r,o as i,c as s,f as p,w as d,h as u,j as m,N as c,n as g,e as h,t as f,O as b}from"./index.1248482e.js";var w=()=>{const{proxy:t}=o(),n=a(!0),r=a(0),i=a([]),s=a(),p=a({pageNum:1,pageSize:10,ipaddr:void 0,userName:void 0}),d=()=>{n.value=!0,(async a=>await e({url:"/monitor/online/list",method:"get",params:a}))(p.value).then((e=>{i.value=e.rows,r.value=parseInt(e.total),n.value=!1}))},u=()=>{p.value.pageNum=1,d()};return l((()=>{d()})),{loading:n,total:r,tablelist:i,queryParams:p,queryFormRef:s,handleQuery:u,resetQuery:()=>{t.resetForm(s),u()},handleForceLogout:a=>{t.$modal.confirm("是否强退【"+a.userName+"】的用户?","警告").then((()=>(async a=>await e({url:"/monitor/online/"+a,method:"delete"}))(a.tokenId))).then((e=>{200===e.code&&(d(),t.$modal.msgSuccess(a.userName+"强退成功！"))})).catch((()=>{}))}}};const y={class:"app-container"},v=h("span",{class:"table_link_text"},"强退",-1),N=t({name:"Online"}),_=t({...N,setup(e){const{loading:a,total:l,tablelist:o,queryParams:t,queryFormRef:N,handleQuery:_,resetQuery:S,handleForceLogout:k}=w();return(e,w)=>{const x=n("el-input"),z=n("el-form-item"),F=n("form-search"),V=n("el-form"),q=n("el-table-column"),R=n("el-link"),I=n("el-table"),K=n("pagination"),L=r("hasPermi"),Q=r("loading");return i(),s("div",y,[p(V,{ref_key:"queryFormRef",ref:N,model:u(t),inline:!0,"label-width":"68px"},{default:d((()=>[p(z,{label:"登录地址",prop:"ipaddr"},{default:d((()=>[p(x,{modelValue:u(t).ipaddr,"onUpdate:modelValue":w[0]||(w[0]=e=>u(t).ipaddr=e),placeholder:"请输入登录地址",clearable:"",onKeyup:m(u(_),["enter","native"])},null,8,["modelValue","onKeyup"])])),_:1}),p(z,{label:"用户名称",prop:"userName"},{default:d((()=>[p(x,{modelValue:u(t).userName,"onUpdate:modelValue":w[1]||(w[1]=e=>u(t).userName=e),placeholder:"请输入用户名称",clearable:"",onKeyup:m(u(_),["enter","native"])},null,8,["modelValue","onKeyup"])])),_:1}),p(F,{onReset:u(S),onSearch:u(_)},null,8,["onReset","onSearch"])])),_:1},8,["model"]),c((i(),g(I,{data:u(o).slice((u(t).pageNum-1)*u(t).pageSize,u(t).pageNum*u(t).pageSize),style:{width:"100%"}},{default:d((()=>[p(q,{label:"序号",type:"index",align:"center",width:"55"},{default:d((e=>[h("span",null,f((u(t).pageNum-1)*u(t).pageSize+e.$index+1),1)])),_:1}),p(q,{label:"会话编号",align:"center",width:"300",prop:"tokenId","show-overflow-tooltip":!0}),p(q,{label:"登录名称",align:"center",prop:"userName","show-overflow-tooltip":!0}),p(q,{label:"部门名称",align:"center",prop:"deptName"}),p(q,{label:"主机",align:"center",prop:"ipaddr","show-overflow-tooltip":!0}),p(q,{label:"登录地点",align:"center",prop:"loginLocation","show-overflow-tooltip":!0}),p(q,{label:"浏览器",align:"center",prop:"browser"}),p(q,{label:"操作系统",align:"center",prop:"os"}),p(q,{label:"登录时间",align:"center",prop:"loginTime",width:"180"},{default:d((a=>[h("span",null,f(e.parseTime(a.row.loginTime)),1)])),_:1}),p(q,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:d((e=>[c((i(),g(R,{underline:!1,class:"table_link_btn",size:"small",type:"warning",icon:"delete",onClick:a=>u(k)(e.row)},{default:d((()=>[v])),_:2},1032,["onClick"])),[[L,["monitor:online:forceLogout"]]])])),_:1})])),_:1},8,["data"])),[[Q,u(a)]]),c(p(K,{total:u(l),page:u(t).pageNum,"onUpdate:page":w[2]||(w[2]=e=>u(t).pageNum=e),limit:u(t).pageSize,"onUpdate:limit":w[3]||(w[3]=e=>u(t).pageSize=e)},null,8,["total","page","limit"]),[[b,u(l)>0]])])}}});export{_ as default};
